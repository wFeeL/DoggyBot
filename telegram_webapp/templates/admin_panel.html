<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='booking.css') }}" />
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Äî DoggyLogy</title>
</head>
<body data-page="admin-panel">
    <div id="tg-required" class="tg-required" style="display:none">
        –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Telegram Mini App.
    </div>

    <div class="container">
        <div class="topbar">
            <div class="brand">
                <div class="brand-title">üêæ DoggyLogy</div>
            </div>
            <div style="display:flex;gap:10px;align-items:center">
                <a class="pill" href="/booking">‚Üê –ó–∞–ø–∏—Å—å</a>
                <a class="pill" href="/client">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
            </div>
        </div>

        <div class="stack">
            <div class="card" id="admin-guard" style="display:none">
                <div class="section-title">
                    <h2>‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω</h2>
                </div>
                <p class="muted">–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.</p>
            </div>

            <div class="card" id="availability-content" style="display:none">
                <div class="section-title">
                    <h2>üóìÔ∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º—è</h2>
                </div>
                <p class="muted">
                    –ó–¥–µ—Å—å –≤—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ, –∫–∞–∫–∏–µ <b>–¥–∞—Ç—ã</b> –∏ <b>—Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –≤—Ä–µ–º–µ–Ω–∞</b> –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —É—Å–ª—É–≥—É.
                    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç <b>—Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</b> –≤–∞—Ä–∏–∞–Ω—Ç—ã.
                </p>

                <div class="stack" style="gap:10px;margin-top:10px">
                    <label class="field">
                        <span class="muted">–£—Å–ª—É–≥–∞</span>
                        <select id="avail-service" class="input"></select>
                    </label>
                    <label class="field">
                        <span class="muted">–î–∞—Ç–∞</span>
                        <input id="avail-date" type="date" class="input" />
                    </label>

                    <div>
                        <div class="muted" style="margin-bottom:8px">–ë—ã—Å—Ç—Ä—ã–µ –¥–∞—Ç—ã</div>
                        <div id="avail-dates-chips" class="chips"></div>
                    </div>

                    <div>
                        <div class="muted" style="margin-bottom:8px">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ä—Ç—ã (–Ω–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å)</div>
                        <div id="avail-grid" class="time-grid"></div>
                    </div>

                    <div class="sheet-actions" style="margin-top:8px">
                        <button class="btn" type="button" id="avail-select-all">–í—ã–±—Ä–∞—Ç—å –≤—Å—ë</button>
                        <button class="btn" type="button" id="avail-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button class="btn" type="button" id="avail-delete">–£–¥–∞–ª–∏—Ç—å –¥–∞—Ç—É</button>
                        <button class="btn btn-primary" type="button" id="avail-save">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>

                    <div id="avail-status" class="muted" style="display:none"></div>
                </div>
            </div>

            <div class="card" id="admin-content" style="display:none">
                <div class="section-title">
                    <h2>üìã –ë—É–¥—É—â–∏–µ –∑–∞–ø–∏—Å–∏</h2>
                    <button class="pill" type="button" id="refresh-bookings">–û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>
                <div id="bookings-root" class="service-list" style="margin-top:12px"></div>
                <div id="bookings-empty" class="muted" style="display:none;margin-top:10px">–ë—É–¥—É—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –Ω–µ—Ç.</div>
            </div>

            <div class="card" id="services-content" style="display:none">
                <div class="section-title">
                    <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</h2>
                </div>
                <div class="stack" style="gap:10px">
                    <label class="field">
                        <span class="muted">–ù–∞–∑–≤–∞–Ω–∏–µ</span>
                        <input id="new-service-name" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è" />
                    </label>
                    <label class="field">
                        <span class="muted">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
                        <input id="new-service-desc" type="text" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ —Å—É—Ç–∏ —É—Å–ª—É–≥–∏" />
                    </label>
                    <div style="display:flex;gap:10px">
                        <label class="field" style="flex:1">
                            <span class="muted">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω)</span>
                            <input id="new-service-duration" type="number" min="15" step="5" value="60" />
                        </label>
                        <label class="field" style="flex:1">
                            <span class="muted">–¶–µ–Ω–∞ (‚ÇΩ)</span>
                            <input id="new-service-price" type="number" min="0" step="50" value="0" />
                        </label>
                    </div>
                    <button class="btn btn-primary" type="button" id="add-service-btn">–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</button>
                    <div id="add-service-status" class="muted" style="display:none"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking details modal -->
    <div id="booking-modal" class="modal" aria-hidden="true">
        <div class="sheet" role="dialog" aria-modal="true">
            <h3 id="booking-modal-title">–ó–∞–ø–∏—Å—å</h3>
            <div id="booking-modal-body" class="muted" style="margin-top:10px"></div>

            <div class="stack" id="booking-edit-block" style="gap:10px;margin-top:12px;display:none">
                <label class="field">
                    <span class="muted">–ù–æ–≤–∞—è –¥–∞—Ç–∞</span>
                    <input id="edit-date" type="date" />
                </label>
                <label class="field">
                    <span class="muted">–ù–æ–≤–æ–µ –≤—Ä–µ–º—è</span>
                    <select id="edit-time"></select>
                </label>
                <div>
                    <div class="muted" style="margin-bottom:6px">–£—Å–ª—É–≥–∏</div>
                    <div id="edit-services" class="service-list"></div>
                </div>
            </div>

            <div class="sheet-actions" style="margin-top:14px">
                <button class="btn" type="button" id="toggle-edit">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn" type="button" id="cancel-booking">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å</button>
                <button class="btn btn-primary" type="button" id="save-booking" style="display:none">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn" type="button" data-close>–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Cancel reason modal -->
    <div id="cancel-modal" class="modal" aria-hidden="true">
        <div class="sheet" role="dialog" aria-modal="true">
            <h3>–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã</h3>
            <p class="muted">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–¥—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –±—É–¥—å—Ç–µ –≤–µ–∂–ª–∏–≤—ã –∏ –∏–∑–≤–∏–Ω–∏—Ç–µ—Å—å –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞.</p>
            <label class="field" style="margin-top:10px">
                <span class="muted">–¢–µ–∫—Å—Ç –ø—Ä–∏—á–∏–Ω—ã</span>
                <input id="cancel-reason" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é" />
            </label>
            <div class="sheet-actions" style="margin-top:14px">
                <button class="btn btn-primary" type="button" id="confirm-cancel">–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
                <button class="btn" type="button" data-close>–ù–∞–∑–∞–¥</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='admin.js') }}"></script>
</body>
</html>
